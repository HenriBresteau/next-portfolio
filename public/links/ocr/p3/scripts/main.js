"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}var Carousel=function(){function i(e){var s=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,i),this.element=e,this.options=Object.assign({},{slidesToScroll:1,slidesVisibles:1},t);var n=[].slice.call(e.children);this.currentItem=0,this.root=this.createDivWithClass("carousel"),this.container=this.createDivWithClass("carousel_container"),this.root.setAttribute("tabindex","0"),this.root.appendChild(this.container),this.element.appendChild(this.root),this.items=n.map(function(e){var t=s.createDivWithClass("carousel_item");return t.appendChild(e),s.container.appendChild(t),t}),this.setStyle(),this.reformatCss(0),this.creationNavigation(),this.root,addEventListener("keyup",function(e){"ArrowRight"===e.key||"Right"===e.key?s.next():"ArrowLeft"!==e.key&&"Left"!==e.key||s.prev(),"ArrowUp"===e.key||"Up"===e.key?s.play():"ArrowDown"!==e.key&&"Down"!==e.key||s.pause()}),this.interval=0}return _createClass(i,[{key:"setStyle",value:function(){var t=this,s=this.items.length/this.options.slidesVisibles;this.container.style.width="100%",this.items.forEach(function(e){return e.style.width=100/t.options.slidesVisibles/s+"%"}),this.items.forEach(function(e){return e.style.transformStyle="preserve-3d"})}},{key:"creationNavigation",value:function(){var e=this.createDivWithClass("carousel_next"),t=this.createDivWithClass("carousel_prev"),s=this.createDivWithClass("carousel_play"),n=this.createDivWithClass("carousel_pause");this.root.appendChild(e),this.root.appendChild(t),this.root.appendChild(s),this.root.appendChild(n),e.addEventListener("click",this.next.bind(this)),t.addEventListener("click",this.prev.bind(this)),s.addEventListener("click",this.play.bind(this)),n.addEventListener("click",this.pause.bind(this))}},{key:"play",value:function(){var e=this;this.interval=window.setInterval(function(){return e.next()},3e3)}},{key:"pause",value:function(){clearInterval(this.interval)}},{key:"next",value:function(){this.goToItem(this.currentItem+this.options.slidesToScroll)}},{key:"prev",value:function(){this.goToItem(this.currentItem-this.options.slidesToScroll)}},{key:"goToItem",value:function(e){e<0?e=this.items.length-this.options.slidesVisibles:(e>=this.items.length||void 0===this.items[this.currentItem+this.options.slidesVisibles])&&(e=0),this.currentItem=e,this.reformatCss(this.currentItem)}},{key:"reformatCss",value:function(e){0===e?(this.items[0].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(0deg)",this.items[1].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(-50deg)",this.items[2].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(-50deg)",this.items[3].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(-50deg)",this.items[4].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(-50deg)"):1===e?(this.items[0].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(50deg)",this.items[1].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(0deg)",this.items[2].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(-50deg)",this.items[3].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(-50deg)",this.items[4].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(-50deg)"):2===e?(this.items[0].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(50deg)",this.items[1].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(50deg)",this.items[2].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(0deg)",this.items[3].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(-50deg)",this.items[4].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(-50deg)"):3===e?(this.items[0].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(50deg)",this.items[1].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(50deg)",this.items[2].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(50deg)",this.items[3].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(0deg)",this.items[4].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(-50deg)"):4===e&&(this.items[0].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(50deg)",this.items[1].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(50deg)",this.items[2].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(50deg)",this.items[3].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(50deg)",this.items[4].style.transform="perspective(7.5cm) rotateX(0deg) rotateY(0deg)")}},{key:"createDivWithClass",value:function(e){var t=document.createElement("div");return t.setAttribute("class",e),t}}]),i}();document.addEventListener("DOMContentLoaded",function(){new Carousel(document.querySelector("#carousel1"),{slidesToScroll:1,slidesVisibles:1})}),document.getElementById("reserver").setAttribute("disabled","disabled");var L=window.L,lyon=[45.75,4.85],map=L.map("mapid").setView(lyon,13);L.tileLayer("https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",{maxZoom:18}).addTo(map);var url="https://api.jcdecaux.com/vls/v1/stations?contract=Lyon&apiKey=91d0d9b75682de4ad09cf88f72a5f08ba6916ed8",oXhr=new XMLHttpRequest;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}oXhr.onload=function(){for(var o=JSON.parse(this.responseText),e=function(r){var e=L.icon({iconUrl:"images/station.png",iconSize:[25,32]});"CLOSED"===o[r].status?o[r].status="Indisponible":o[r].status="Disponible";var t=L.marker([o[r].position.lat,o[r].position.lng],{icon:e}).addTo(map);t.bindPopup("<h5>"+o[r].name+"</h5> <p>"+o[r].address+' </p> <p> Etat de station : <span class="indisponible">'+o[r].status+"</span></p><p> Total places : "+o[r].bike_stands+"</p>"),t.addEventListener("click",function(){var e,t,s,n,i;e=r,document.querySelector(".station").textContent=o[e].name,document.querySelector(".adresse").textContent=o[e].address,document.querySelector(".place").textContent=o[e].bike_stands,document.querySelector(".disponible").textContent=o[e].available_bike_stands,t=e,s=document.querySelector(".disponible"),0<o[t].available_bike_stands?s.style.color="green":(s.style.color="red",s.style.fontWeight="600"),"Indisponible"===o[n=r].status||0===o[n].available_bike_stands?document.querySelector(".indisponible").style.color="red":(document.getElementById("reserver").removeAttribute("disabled"),document.querySelector(".indisponible").style.color="green"),document.querySelector(".indisponible").style.fontWeight="600",(i=document.querySelector("canvas")).style.display="initial",i.style.backgroundColor="lightgray",document.getElementById("from").style.display="initial",document.querySelector("#signature").style.display="initial"})},t=0;t<o.length;t++)e(t)},oXhr.onerror=function(e){},oXhr.open("GET",url,!0),oXhr.send(null);var CanvasObjet=function(){function e(){_classCallCheck(this,e),this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.ctx.strokeStyle="#000000",this.ctx.lineWidth=3,this.draw=!1,this.mousePosition={x:0,y:0},this.lastPosition=this.mousePosition,this.clearButton=document.querySelector("#btn_clear"),this.canvas.width=200,this.canvas.height=150}return _createClass(e,[{key:"evenements",value:function(){var t=this;this.canvas.addEventListener("mousedown",function(e){t.draw=!0,t.lastPosition=t.getMposition(e)}),this.canvas.addEventListener("mousemove",function(e){t.mousePosition=t.getMposition(e),t.canvasResult()}),document.addEventListener("mouseup",function(e){t.draw=!1}),this.clearButton.addEventListener("click",function(e){t.clearCanvas()})}},{key:"getMposition",value:function(e){if(this.draw){var t=this.canvas.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}}},{key:"canvasResult",value:function(){this.draw&&(this.ctx.beginPath(),this.ctx.moveTo(this.lastPosition.x,this.lastPosition.y),this.ctx.lineTo(this.mousePosition.x,this.mousePosition.y),this.ctx.stroke(),this.lastPosition=this.mousePosition)}},{key:"clearCanvas",value:function(){this.canvas.width=this.canvas.width,this.ctx.lineWidth=3}}]),e}(),obj=new CanvasObjet;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}obj.evenements();var Nomlocal=function(){function e(){_classCallCheck(this,e),this.nomElt=document.getElementById("nom"),this.prenomElt=document.getElementById("prenom"),this.reserverElt=document.getElementById("reserver"),this.effacerElt=document.getElementById("btn_clear"),this.stocker(),this.effacer()}return _createClass(e,[{key:"stocker",value:function(){var s=this;localStorage&&sessionStorage&&this.reserverElt.addEventListener("click",function(){localStorage.clear();var e={nom:s.nomElt.value,prenom:s.prenomElt.value};localStorage.setItem("iden",JSON.stringify(e));var t=JSON.parse(localStorage.getItem("iden"));0==t.lenght||(s.nomElt.value=t.nom,s.prenomElt.value=t.prenom)})}},{key:"effacer",value:function(){var e=this;this.effacerElt.addEventListener("click",function(){e.nomElt.value="",e.prenomElt.value=""})}}]),e}(),loc=new Nomlocal;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}var SessionStorage=function(){function e(){_classCallCheck(this,e),this.nom=document.getElementById("nom"),this.prenom=document.getElementById("prenom"),this.reserverElt=document.getElementById("reserver"),this.effacerElt=document.getElementById("btn_clear"),this.station=document.querySelector(".station"),this.missNom=document.getElementById("missNom"),this.formatNom=document.getElementById("formatNom"),this.formatPrenom=document.getElementById("formatPrenom"),this.recapElt=document.getElementById("recap"),this.minElt=document.getElementById("min"),this.secElt=document.getElementById("sec"),this.checkInput(),this.chrono(),this.counterSec=0,this.counterMin=0}return _createClass(e,[{key:"checkInput",value:function(){var i=/^[zA-ZéèîïÉÈÎÏ][zA-ZéèîïÉÈÎÏ]+([-'\s][zA-ZéèîïÉÈÎÏ][zA-ZéèîïÉÈÎÏ]+)?$/,r=/^[zA-ZéèîïÉÈÎÏ][a-zéèêàçîï]+([-'\s][a-zA-ZéèîïÉÈÎÏ][a-zéèêàçîï]+)?$/;this.reserverElt.addEventListener("mouseover",function(){var e=o.nom.validity.valueMissing,t=o.prenom.validity.valueMissing,s=i.test(o.nom.value),n=r.test(o.prenom.value);e||t?(o.missNom.textContent="Attention ! Nom et prenom sont obligatoire pour réserver !",o.missNom.style.color="red"):o.missNom.textContent="";o.formatNom.style.color=0==s?"orange":"green";o.formatPrenom.style.color=0==n?"orange":"green";e||t||1!=s||1!=n?o.recapElt.style.display="none":(o.reserverElt.removeAttribute("disabled"),o.reserverElt.addEventListener("click",function(e){o.recapElt.style.display="block",o.recapElt.style.backgroundColor="peachpuff",o.recapElt.style.padding="10px";var t=document.getElementById("station");t.textContent=o.station.textContent,nomResa.textContent=o.nom.value,prenomResa.textContent=o.prenom.value}))});var o=this}},{key:"chrono",value:function(){var e=this,t=null,s=document.getElementById("fin");function n(){clearInterval(t),s.style.display="initial",s.style.color="red"}function i(){e.counterSec--,e.counterSec<0&&(e.counterSec=59,e.counterMin--),0==e.counterSec&&e.counterMin<=0?n():(e.secElt.innerHTML=e.counterSec,sessionStorage.setItem("Secondes :",e.counterSec),e.minElt.innerHTML=e.counterMin,sessionStorage.setItem("Minutes :",e.counterMin))}this.reserverElt.addEventListener("click",function(){n(),e.counterSec=59,e.counterMin=19,s.style.display="none",t=setInterval(i,1e3)}),this.effacerElt.addEventListener("click",function(){clearInterval(t),sessionStorage.clear()})}}]),e}(),session=new SessionStorage;